{% extends "base.html" %}

{% load static %}
{% load custom_date %}
{% load airlines %}
{% load airline_icons %}
{% load comparison %}
{% load time_duration %}
{% load return_flight %}

{% block csscontent %}
    <link rel="stylesheet" href="{% static "css/lightpick.css" %}" xmlns:v-on="http://www.w3.org/1999/xhtml"
          xmlns:v-on="http://www.w3.org/1999/xhtml">
    <link rel="stylesheet" href="{% static "css/bootstrap-slider.min.css" %}">
    <link rel="stylesheet" href="{% static "css/custom.css" %}">
    <link rel="stylesheet" href="{% static "css/results.css" %}">
{% endblock %}


{% block content %}
    <section class="navbar-section">
        {% include "_includes/navbar.html" %}
    </section>
    <section class="search-bar-section bg-white border-bottom">
        <div class="sidebar__inner">
            <div class="container content-holder wide-container" style="padding-bottom: 20px;">
                <div class="search_content_box" style="padding-top: 20px; padding-bottom: 20px;">
                    {% csrf_token %}
                    <div class="row sidebar__inner">
                        <div class="container wide-container">
                            <div class="col-12 pr-0">
                                <div class="row">
                                    <div class="col-12 mt-2 col-md-auto search-column-dropdown">
                                        <img src="{% static "images/icons/arrows_rotating.png" %}">
                                        <input type="text" class="drop_down_btn" readonly data-toggle="dropdown"
                                               aria-haspopup="true"
                                               aria-expanded="false" name="destinationType" id="destinationType"
                                               v-model="form.destinationType"/>

                                        <div class="dropdown-menu">
                                            <a class="dropdown-item drop_down_btn_item" @click="selectDestType(1)">
                                                Return
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item drop_down_btn_item" @click="selectDestType(2)">One
                                                way</a>
                                        </div>
                                    </div>
                                    <div class="col-12 mt-2 col-md-auto search-column-dropdown">
                                        <img src="{% static "images/icons/man_user.png" %}">
                                        <input type="text" class="drop_down_btn" readonly data-toggle="modal"
                                               data-target="#passengersModal"
                                               value="Passengers" name="noOfPassengers" id="noOfPassengers"
                                               v-model="form.noOfPassengers"/>
                                    </div>
                                    <div class="col-12 mt-2 col-md-auto search-column-dropdown">
                                        <img src="{% static "images/icons/dollar.png" %}">
                                        <input type="text" class="drop_down_btn" readonly data-toggle="dropdown"
                                               aria-haspopup="true" aria-expanded="false" name="seatType" id="seatType"
                                               v-model="form.seatType"/>
                                        <div class="dropdown-menu">
                                            <a class="dropdown-item drop_down_btn_item"
                                               @click="selectSeatType(1)">Economy</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item drop_down_btn_item" @click="selectSeatType(2)">Premium
                                                Economy</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item drop_down_btn_item"
                                               @click="selectSeatType(3)">Business</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item drop_down_btn_item" @click="selectSeatType(4)">First
                                                Class</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-sm-12 flexed-search-bar pl-0">
                                        <div class="flexed-search-item">
                                            <label class="search_label" @click="openPlaceModal(1)">
                                                <h6>Departure
                                                    City :
                                                    <input type="text" class="search_input" readonly name="placesFrom"
                                                           id="placesFrom"
                                                           value="{{ request.session.search_query.fly_from }}"/>
                                                </h6>
                                            </label>
                                            <img class="icon_repeat" src="{% static "images/repeat.svg" %}"
                                                 @click="swapPlaces">
                                        </div>
                                        <div class="flexed-search-item">
                                            <label class="search_label" @click="openPlaceModal(2)">
                                                <h6>
                                                    Arrival City :
                                                    <input type="text" class="search_input" readonly name="placesTo"
                                                           id="placesTo"
                                                           value="{{ request.session.search_query.fly_to }}"/>
                                                </h6>
                                            </label>
                                        </div>
                                        <div class="flexed-search-item">
                                            <label class="search_label">
                                                <h6>Departure
                                                    Date :
                                                    <input type="text" name="dep_date" id="departure_date"
                                                           class="search_input"
                                                           value="{{ request.session.search_query.date_from }}">
                                                </h6>
                                            </label>
                                        </div>
                                        <div class="flexed-search-item">
                                            <label class="search_label">
                                                <h6 style="font-family: karla; font-weight:bold; opacity: .5;">Return
                                                    Date :
                                                    <input type="text" name="ret_date" id="return_date"
                                                           class="search_input"
                                                           value="{{ request.session.search_query.return_from }}">
                                                </h6>
                                            </label>
                                        </div>
                                        <div class="flexed-search-item">
                                            <button class="search_btn"
                                                    @click="search">Search
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container wide-container d-none">
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label class="mr-3"> <strong>Stops: </strong></label>
                            <div class="divider-30 d-block d-md-none"></div>
                            <div class="form-check-inline">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input mr-2" name="stop" value="">Any
                                </label>
                            </div>
                            <div class="divider-15 d-block d-md-none"></div>
                            <div class="form-check-inline">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input mr-2" name="stop" value="0" checked>Nonestop
                                    (Direct
                                    Flights)
                                </label>
                            </div>
                            <div class="divider-15 d-block d-md-none"></div>
                            <div class="form-check-inline">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input mr-2" name="stop" value="1">1 Stop
                                </label>
                            </div>
                            <div class="divider-15 d-block d-md-none"></div>
                            <div class="form-check-inline">
                                <label class="form-check-label">
                                    <input type="radio" class="form-check-input mr-2" name="stop" value="2">2+ Stops
                                </label>
                            </div>
                            <div class="divider-30 d-block d-md-none"></div>
                            <label class="mr-4"><strong>Layover:</strong></label>
                            <br class="d-block d-md-none">
                            <div class="divider-30 d-block d-md-none"></div>
                            <div class="slider-red slider-holder d-inline-block mr-4">
                                <input id="stopover" type="text" value="" class="form-control">
                            </div>
                            <label class="stopover mr-2">2 - 24 hours</label>

                        </div>
                    </div>
                </div>
                <div class="modal fade" id="passengersModal" tabindex="-1" role="dialog"
                     aria-labelledby="passengersModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content" style="top: 5%;">
                            <div class="modal-header">
                                <h6 class="modal-title" id="passengersModalLabel">Passengers</h6>
                            </div>
                            <div class="modal-body">
                <span style="padding: 0 2%">

                    <div class="container">
                      <div class="row">
                        <div class="col-sm">
                          Adults
                        </div>
                        <div class="col-sm">
                          <input type="button" class="increment" value="-" @click="decrement(1)"
                                 id="valAdultsDecrement"/>

                              <input type="text" readonly
                                     style="padding: 1% 2%; width: 15%; border: none; text-align: center"
                                     v-model="form.valAdults" id="valAdults"/>
                           <input type="button" class="increment" id="valAdultsIncrement" value="+"
                                  @click="increment(1)"/>
                        </div>
                      </div>
                    </div>

                    <div class="dropdown-divider"></div>
                    <div class="container">
                      <div class="row">
                        <div class="col-sm">
                          Children
                        </div>
                        <div class="col-sm">
                          <input type="button" class="increment" value="-" @click="decrement(2)"
                                 id="valChildrenDecrement"/>

                              <input type="text" readonly
                                     style="padding: 1% 2%; width: 15%; border: none; text-align: center"
                                     v-model="form.valChildren" id="valChildren"/>
                           <input type="button" class="increment" value="+" @click="increment(2)"
                                  id="valChildrenIncrement"/>
                        </div>
                      </div>
                    </div>
                    <div class="dropdown-divider"></div>
                 <div class="container">
                      <div class="row">
                        <div class="col-sm">
                          Infants
                        </div>
                        <div class="col-sm">
                          <input type="button" class="increment" value="-" @click="decrement(3)"
                                 id="valInfantsDecrement"/>

                              <input type="text" readonly
                                     style="padding: 1% 2%; width: 15%; border: none; text-align: center"
                                     v-model="form.valInfants" id="valInfants"/>
                          <input type="button" class="increment" value="+" @click="increment(3)"
                                 id="valInfantsIncrement"/>
                        </div>
                      </div>
                    </div>
                </span>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn" style="width: 50%; background: aliceblue;"
                                        data-dismiss="modal">Close
                                </button>
                                <button type="button" class="btn" style="width: 50%; background: #00B7FF;color: #fff"
                                        data-dismiss="modal">Save changes
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section style="padding-bottom: 50px; background-color: #F7F9FF; padding-top: 30px; ">
        <div class="results-page">
            <div class="container results-container" id="resultsContainer">
                <div class="row">
                    <div class="col-xl-3">
                        <div class="s-sidebar">
                            <div class="sticky-item">
                                <div class="card bg-white">
                                    <div class="card-body">
                                        <div class="card-title mb-4">
                                            <h4 class="bold p-0 mt-0" style="font-size: 1.2rem; font-weight: 600;">
                                                Subscribe to
                                                Wanderift Lift or Pro and Save</h4>
                                        </div>
                                        <h5 class="bold m-0 mb-2" style="font-weight: 600; padding-bottom: 5px;">
                                            Wanderift
                                            Lite</h5>
                                        <h6 class="bold m-0 mb-2" style="padding-bottom: 10px;"><span
                                                class="text-primary"
                                                style="color: #00B7FF;">3</span>
                                            Flights <span class="text-primary">$369</span></h6>
                                        <p class="" style="font-size: 14px;">- 3 Tokens (3 one-way flights)</p>
                                        <p class="" style="font-size: 14px;">- 1 Unused Token Rolls over</p>
                                        <p class="" style="font-size: 14px;">- No Long Term Commitment</p>
                                        <a href="{% url "how-it-works" %}">
                                            <button class="search_btn btn-block m-0" style="font-weight: bold;">Learn
                                                More
                                            </button>
                                        </a>
                                        <br><br>
                                        <h5 class="bold m-0 mb-2" style="font-weight: 600; padding-bottom: 5px;">
                                            Wanderift
                                            Pro</h5>
                                        <h6 class="bold m-0 mb-2" style="padding-bottom: 10px;"><span
                                                class="text-primary">4</span> Flights <span
                                                class="text-primary">$459</span>
                                        </h6>
                                        <p class="" style="font-size: 14px;">- 4 Tokens (4 one-way flights)</p>
                                        <p class="" style="font-size: 14px;">- 2 Unused Token Rolls over</p>
                                        <p class="" style="font-size: 14px;">- No Long Term Commitment</p>
                                        <a href="{% url "how-it-works" %}">
                                            <button class="search_btn btn-block m-0" style="font-weight: bold;">Learn
                                                More
                                            </button>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 search result p-3 p-md-0">
                        {% for flight in data.data %}
                            {% if flight.availability.seats > 0 %}
                                {% if flight.routes|length > 1 %}
                                    <div class="result-item mb-2 w-100">
                                        <div class="result-block result-toggler w-100 d-block d-md-flex justify-content-start p-2 pt-3 pb-3"
                                             data-toggle="collapse"
                                             data-target="#result-item{{ flight.duration.total }}">
                                            <div class="price-block d-flex align-items-center justify-content-center pl-3 pr-3">
                                                <div>
                                                    <h5>$ {{ flight.price }}</h5>
                                                    <p class="small text-muted">1 Adult</p>
                                                </div>
                                            </div>
                                            <div class="flight-info-block d-flex flex-column w-100">
                                                <div class="departure-row d-flex justify-content-start">
                                                    <div class="airline-logo-holder d-flex"
                                                         data-stopnum="{{ flight.duration.total }}">
                                                        {% for route in flight.route %}
                                                            {% if route.return == 0 %}
                                                                <div class="img-airline">
                                                                    <div class="airline">
                                                                        <img src="/images/{{ route.airline |aircon }}.png"
                                                                             alt="AA"
                                                                             style="width:25px; margin-right: 4px;">
                                                                    </div>
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                    <div class="d-flex justify-content-around w-100">
                                                        <div class="">
                                                            <label class="mb-0"><strong>
                                                                {{ flight.local_departure | iso_date | date:"h:i A" }} -
                                                                {{ flight.local_arrival | iso_date | date:"h:i A" }}</strong></label><br>
                                                            <span class="small text-muted">
                                            {{ flight.cityFrom }}
                                            <i class="fa fa-long-arrow-right mr-1 ml-1"></i>
                                            {{ flight.cityTo }}
                                        </span>
                                                        </div>
                                                        <div class="">
                                                            <label class="mb-0">
                                                                <strong>{{ flight.local_departure | iso_date | date:"D j M" }}</strong>
                                                            </label>
                                                            <br>
                                                            <span class="small text-muted">{{ flight | time_interval }}</span>
                                                        </div>
                                                        <div></div>
                                                    </div>

                                                </div>
                                                <div class="flight-divider d-flex justify-content-start text-left mt-2 mb-2">
                                                    <span style="width: 50px; border-bottom: 1px solid silver; height: 12px;"></span>
                                                    <p class="small text-muted mb-0 ml-3">
                                                        Stays about {{ flight.nightsInDest }} days
                                                        in {{ flight.cityTo }}
                                                    </p>
                                                </div>


                                                <div class="arrival-row d-flex justify-content-start">
                                                    <div class="airline-logo-holder d-flex"
                                                         data-stopnum="{{ flight.duration.total }}">
                                                        {% for route in flight.route %}
                                                            {% if route.return == 1 %}
                                                                <div class="img-airline">
                                                                    <div class="airline">
                                                                        <img src="/images/{{ route.airline |aircon }}.png"
                                                                             alt="AA"
                                                                             style="width:25px; margin-right: 4px;">
                                                                    </div>
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                    <div class="d-flex justify-content-around w-100">

                                                        <div class="">

                                                            <label class="mb-0"><strong>{{ flight.route | return_date | last | iso_date | date:"h:i A" }}
                                                                -
                                                                {{ route_last.local_departure | iso_date | date:"h:i A" }}</strong></label>
                                                            <br>
                                                            <span class="small text-muted"> {{ flight.cityTo }}
                                                                        <i class="fa fa-long-arrow-right mr-1 ml-1"></i>
                                                                            {{ flight.cityFrom }}
                                                                    </span>
                                                        </div>
                                                        <div class="">
                                                            <label class="mb-0">
                                                                <strong>{{ route_last.local_arrival | iso_date | date:"D j M" }}</strong>
                                                            </label>
                                                            <br>
                                                            <span class="small text-muted">{{ route_last | time_interval }}</span>
                                                        </div>
                                                        <div></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="arrow-indicator p-2 pt-3 pr-md-5 d-flex align-items-center justify-content-center">
                                                <img src="{% static "images/icons/down-arrow.png" %}" alt="Pull down"
                                                     height="15" class="">
                                                <img src="{% static "images/icons/up-arrow.png" %}" alt="Pull up"
                                                     height="15" class="d-none">
                                            </div>
                                        </div>

                                        <div class="result-details collapse container-fluid"
                                             id="result-item{{ flight.duration.total }}">
                                            <hr class="m-0">
                                            {% with flight.route|first as route_one %}
                                                {% if route_one %}
                                                    <div class="route-box row">
                                                    <div class="col-12 col-md-6 departure-block border-right pt-4 pb-4">
                                                        <h6 class="text-muted mb-3">
                                                            DEPARTURE
                                                            <span class="small ml-2">Duration:</span>
                                                            <span class="small">5h 28m</span>
                                                        </h6>
                                                        <p class="mb-2 dark-text">
                                                            <strong class="">
                                                                <i class="fa fa-calendar mr-2"></i>
                                                                {{ route_one.local_departure | iso_date | date:"D j M" }}
                                                            </strong>
                                                        </p>
                                                        {% for route in flight.route %}
                                                            {% if route.return == 0 %}

                                                                <div class="d-flex align-items-center position-relative">
                                                                    <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                                    <div class="card w-100 cursor-pointer"
                                                                         data-toggle="collapse"
                                                                         data-target="#airplane1">
                                                                        <div class="card-body p-0">
                                                                            <div class="d-flex justify-content-between pl-2">
                                                                                <div class="mr-auto">
                                                                                    <div class="airlines-labels">
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_departure | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityFrom }} {{ route.flyFrom }}</span>
                                                                                        </label>
                                                                                        <br>
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_arrival | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityTo }} {{ route.flyTo }}</span>
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="d-flex">
                                                                                    <img src="/images/{{ route.airline |aircon }}.png"
                                                                                         alt="Airline"
                                                                                         class="align-self-center"
                                                                                         height="32px">
                                                                                </div>
                                                                                <div class="col-1 text-right d-flex">
                                                                                    <img src="{% static "images/arrow.png" %}"
                                                                                         style="width: 10px; height: 5px;"
                                                                                         class="align-self-center">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-footer collapse"
                                                                             id="airplane1">
                                                                            <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Flight No.</label>
                                                                                <label class="text-grey">{{ route.flight_no }}
                                                                                </label>
                                                                            </div>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Seats Remaining</label>
                                                                                <label class="text-grey">{{ flight.availability.seats }}
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <span class="position-absolute duration-indicator small text-muted">{{ route | time_interval }}</span>
                                                                </div>

                                                                <div class="d-flex pt-3 pl-4 pb-3">
                                                                    <i class="fa fa-clock-o mr-2"></i>
                                                                    <p class="small text-muted mb-0">{{ route | time_interval }}
                                                                        layover</p>
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}

                                                        <div class="d-flex pt-3 pl-4 pb-3">
                                                            <i class="fa fa-bed mr-2"></i>
                                                            <p class="small text-muted mb-0">{{ flight.nightsInDest }}
                                                                nights in {{ flight.cityTo }}</p>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            {% endwith %}

                                            <!-----------Return Flights ------------------------>
                                            {% with flight.route|last as route_one %}
                                                {% if route_one %}
                                                    <div class="col-12 col-md-6 return-block pt-4">
                                                        <h6 class="text-muted mb-3">
                                                            RETURN
                                                            <span class="small ml-2">Duration:</span>
                                                            <span class="small">5h 28m</span>
                                                        </h6>
                                                        <p class="mb-2 dark-text">
                                                            <strong class="">
                                                                <i class="fa fa-calendar mr-2"></i>
                                                                {{ route_one.local_departure | iso_date | date:"D j M" }}
                                                            </strong>
                                                        </p>

                                                        {% for route in flight.route %}
                                                            {% if route.return == 1 %}
                                                                <div class="d-flex align-items-center position-relative">
                                                                    <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                                    <div class="card w-100 cursor-pointer"
                                                                         data-toggle="collapse"
                                                                         data-target="#airplane3">
                                                                        <div class="card-body p-0">
                                                                            <div class="d-flex justify-content-between pl-2">
                                                                                <div class="mr-auto">
                                                                                    <div class="airlines-labels">
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_departure | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityFrom }} {{ route.flyFrom }}</span>
                                                                                        </label>
                                                                                        <br>
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_arrival | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityTo }} {{ route.flyTo }}</span>
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="d-flex">
                                                                                    <img src="/images/{{ route.airline |aircon }}.png"
                                                                                         alt="Airline"
                                                                                         class="align-self-center"
                                                                                         height="32px">
                                                                                </div>
                                                                                <div class="col-1 text-right d-flex">
                                                                                    <img src="{% static "images/arrow.png" %}"
                                                                                         style="width: 10px; height: 5px;"
                                                                                         class="align-self-center">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-footer collapse"
                                                                             id="airplane3">
                                                                            <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Flight No.</label>
                                                                                <label class="text-grey">{{ route.flight_no }}
                                                                                </label>
                                                                            </div>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Seats Remaining</label>
                                                                                <label class="text-grey">{{ flight.availability.seats }}
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <span class="position-absolute duration-indicator small text-muted">{{ route | time_interval }}</span>
                                                                </div>
                                                                <div class="d-flex pt-3 pl-4 pb-3">
                                                                    <i class="fa fa-clock-o mr-2"></i>
                                                                    <p class="small text-muted mb-0"> {{ route | time_interval }}
                                                                        layover</p>
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}
                                                        <div class="d-flex pt-3 pl-4 pb-3">
                                                            <i class="fa fa-bed mr-2"></i>
                                                            <p class="small text-muted mb-0">{{ flight.nightsInDest }}
                                                                nights in {{ flight.cityTo }}</p>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            {% endwith %}
                                            <!-------------End Return flights------------------->
                                            </div>
                                            <div class="search-results-buttons text-right p-2 pt-3">
                                                {% if flight.routes|length > 1 and flight.price > 369 %}
                                                    <a href="{% url 'subscription' %}">
                                                        <button class="search_btn mb-1">Subscribe and save
                                                            ${{ flight | comparison }}</button>
                                                    </a>
                                                {% endif %}
                                                {% if flight.routes|length == 1 and flight.price > 185 %}
                                                    <a href="{% url 'subscription' %}">
                                                        <button class="search_btn mb-1">Subscribe and save
                                                            ${{ flight | comparison }}</button>
                                                    </a>
                                                {% endif %}
                                                <a href="{% url 'retail' flight.booking_token %}">
                                                    <button class="search_btn book-btn mt-1"> Book for
                                                        ${{ flight.price }}</button>
                                                </a>
                                            </div>
                                        </div>

                                    </div>
                                {% else %}
                                    <div class="result-item mb-2 w-100">
                                        <div class="result-block result-toggler w-100 d-block d-md-flex justify-content-start p-2 pt-3 pb-3"
                                             data-toggle="collapse"
                                             data-target="#result-item{{ flight.duration.total }}">
                                            <div class="price-block d-flex align-items-center justify-content-center pl-3 pr-3">
                                                <div>
                                                    <h5>$ {{ flight.price }}</h5>
                                                    <p class="small text-muted">1 Adult</p>
                                                </div>
                                            </div>
                                            <div class="flight-info-block d-flex flex-column w-100">
                                                <div class="departure-row d-flex justify-content-start">
                                                    <div class="airline-logo-holder d-flex"
                                                         data-stopnum="{{ flight.duration.total }}">
                                                        {% for airline in flight.airlines %}
                                                            <div class="img-airline">
                                                                <div class="airline">
                                                                    <img src="/images/{{ airline |aircon }}.png"
                                                                         alt="AA"
                                                                         style="width:25px; margin-right: 4px;">
                                                                </div>
                                                            </div>
                                                        {% endfor %}
                                                    </div>
                                                    <div class="d-flex justify-content-around w-100">
                                                        <div class="">
                                                            <label class="mb-0"><strong>
                                                                {{ flight.local_departure | iso_date | date:"h:i A" }} -
                                                                {{ flight.local_arrival | iso_date | date:"h:i A" }}</strong></label><br>
                                                            <span class="small text-muted">
                                            {{ flight.cityFrom }}
                                            <i class="fa fa-long-arrow-right mr-1 ml-1"></i>
                                            {{ flight.cityTo }}
                                        </span>
                                                        </div>
                                                        <div class="">
                                                            <label class="mb-0">
                                                                <strong>{{ flight.local_departure | iso_date | date:"D j M" }}</strong>
                                                            </label>
                                                            <br>
                                                            <span class="small text-muted">{{ flight | time_interval }}</span>
                                                        </div>
                                                        <div></div>
                                                    </div>

                                                </div>
                                            </div>

                                            <div class="arrow-indicator p-2 pt-3 pr-md-5 d-flex align-items-center justify-content-center">
                                                <img src="{% static "images/icons/down-arrow.png" %}" alt="Pull down"
                                                     height="15" class="">
                                                <img src="{% static "images/icons/up-arrow.png" %}" alt="Pull up"
                                                     height="15" class="d-none">
                                            </div>
                                        </div>

                                        <div class="result-details collapse container-fluid"
                                             id="result-item{{ flight.duration.total }}">
                                            <hr class="m-0">
                                            {% with flight.route|first as route_one %}
                                                {% if route_one %}
                                                    <div class="route-box row">
                                                    <div class="col-12 col-md-6 departure-block border-right pt-4 pb-4">
                                                        <h6 class="text-muted mb-3">
                                                            DEPARTURE
                                                            <span class="small ml-2">Duration:</span>
                                                            <span class="small">5h 28m</span>
                                                        </h6>
                                                        <p class="mb-2 dark-text">
                                                            <strong class="">
                                                                <i class="fa fa-calendar mr-2"></i>
                                                                {{ route_one.local_departure | iso_date | date:"D j M" }}
                                                            </strong>
                                                        </p>
                                                        {% for route in flight.route %}
                                                            {% if route.return == 0 %}

                                                                <div class="d-flex align-items-center position-relative">
                                                                    <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                                    <div class="card w-100 cursor-pointer"
                                                                         data-toggle="collapse"
                                                                         data-target="#airplane1">
                                                                        <div class="card-body p-0">
                                                                            <div class="d-flex justify-content-between pl-2">
                                                                                <div class="mr-auto">
                                                                                    <div class="airlines-labels">
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_departure | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityFrom }} {{ route.flyFrom }}</span>
                                                                                        </label>
                                                                                        <br>
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_arrival | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityTo }} {{ route.flyTo }}</span>
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="d-flex">
                                                                                    <img src="/images/{{ route.airline |aircon }}.png"
                                                                                         alt="Airline"
                                                                                         class="align-self-center"
                                                                                         height="32px">
                                                                                </div>
                                                                                <div class="col-1 text-right d-flex">
                                                                                    <img src="{% static "images/arrow.png" %}"
                                                                                         style="width: 10px; height: 5px;"
                                                                                         class="align-self-center">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-footer collapse"
                                                                             id="airplane1">
                                                                            <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Flight No.</label>
                                                                                <label class="text-grey">{{ route.flight_no }}
                                                                                </label>
                                                                            </div>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Seats Remaining</label>
                                                                                <label class="text-grey">{{ flight.availability.seats }}
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <span class="position-absolute duration-indicator small text-muted">{{ route | time_interval }}</span>
                                                                </div>

                                                                <div class="d-flex pt-3 pl-4 pb-3">
                                                                    <i class="fa fa-clock-o mr-2"></i>
                                                                    <p class="small text-muted mb-0">{{ route | time_interval }}
                                                                        layover</p>
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}

                                                        <div class="d-flex pt-3 pl-4 pb-3">
                                                            <i class="fa fa-bed mr-2"></i>
                                                            <p class="small text-muted mb-0">{{ flight.nightsInDest }}
                                                                nights in {{ flight.cityTo }}</p>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            {% endwith %}

                                            <!-----------Return Flights ------------------------>
                                            {% with flight.route|last as route_one %}
                                                {% if route_one %}
                                                    <div class="col-12 col-md-6 return-block pt-4">
                                                        <h6 class="text-muted mb-3">
                                                            RETURN
                                                            <span class="small ml-2">Duration:</span>
                                                            <span class="small">5h 28m</span>
                                                        </h6>
                                                        <p class="mb-2 dark-text">
                                                            <strong class="">
                                                                <i class="fa fa-calendar mr-2"></i>
                                                                {{ route_one.local_departure | iso_date | date:"D j M" }}
                                                            </strong>
                                                        </p>

                                                        {% for route in flight.route %}
                                                            {% if route.return == 1 %}
                                                                <div class="d-flex align-items-center position-relative">
                                                                    <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                                    <div class="card w-100 cursor-pointer"
                                                                         data-toggle="collapse"
                                                                         data-target="#airplane3">
                                                                        <div class="card-body p-0">
                                                                            <div class="d-flex justify-content-between pl-2">
                                                                                <div class="mr-auto">
                                                                                    <div class="airlines-labels">
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_departure | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityFrom }} {{ route.flyFrom }}</span>
                                                                                        </label>
                                                                                        <br>
                                                                                        <label class="mb-0">
                                                                                            <span class="dark-text">{{ route.local_arrival | iso_date | date:"h:i A" }}</span>
                                                                                            <span class="text-muted">{{ route.cityTo }} {{ route.flyTo }}</span>
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="d-flex">
                                                                                    <img src="/images/{{ route.airline |aircon }}.png"
                                                                                         alt="Airline"
                                                                                         class="align-self-center"
                                                                                         height="32px">
                                                                                </div>
                                                                                <div class="col-1 text-right d-flex">
                                                                                    <img src="{% static "images/arrow.png" %}"
                                                                                         style="width: 10px; height: 5px;"
                                                                                         class="align-self-center">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-footer collapse"
                                                                             id="airplane3">
                                                                            <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Flight No.</label>
                                                                                <label class="text-grey">{{ route.flight_no }}
                                                                                </label>
                                                                            </div>
                                                                            <div class="d-inline-flex justify-content-between w-100">
                                                                                <label>Seats Remaining</label>
                                                                                <label class="text-grey">{{ flight.availability.seats }}
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <span class="position-absolute duration-indicator small text-muted">{{ route | time_interval }}</span>
                                                                </div>
                                                                <div class="d-flex pt-3 pl-4 pb-3">
                                                                    <i class="fa fa-clock-o mr-2"></i>
                                                                    <p class="small text-muted mb-0"> {{ route | time_interval }}
                                                                        layover</p>
                                                                </div>
                                                            {% endif %}
                                                        {% endfor %}
                                                        <div class="d-flex pt-3 pl-4 pb-3">
                                                            <i class="fa fa-bed mr-2"></i>
                                                            <p class="small text-muted mb-0">{{ flight.nightsInDest }}
                                                                nights in {{ flight.cityTo }}</p>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            {% endwith %}
                                            <!-------------End Return flights------------------->
                                            </div>
                                            <div class="search-results-buttons text-right p-2 pt-3">
                                                {% if flight.routes|length > 1 and flight.price > 369 %}
                                                    <a href="{% url 'subscription' %}">
                                                        <button class="search_btn mb-1">Subscribe and save
                                                            ${{ flight | comparison }}</button>
                                                    </a>
                                                {% endif %}
                                                {% if flight.routes|length == 1 and flight.price > 185 %}
                                                    <a href="{% url 'subscription' %}">
                                                        <button class="search_btn mb-1">Subscribe and save
                                                            ${{ flight | comparison }}</button>
                                                    </a>
                                                {% endif %}
                                                <a href="{% url 'retail' flight.booking_token %}">
                                                    <button class="search_btn book-btn mt-1"> Book for
                                                        ${{ flight.price }}</button>
                                                </a>
                                            </div>
                                        </div>

                                    </div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        <button class="load-more-button">Load More</button>
                    </div>
                    <div class="col-xl-3">
                        <div class="s-sidebar">
                            <div class="sticky-item">
                                <div class="card">
                                    <div class="card-header card-toggler bg-white cursor-pointer" data-toggle="collapse"
                                         data-target="#airlineFilter">
                                        <div class="card-title mb-0 d-flex align-items-center justify-content-between">
                                            <h5 class="mb-0 p-2">Airline</h5>
                                            <img src="{% static "images/icons/up-arrow.png" %}" alt="Pull Up" class=""
                                                 height="10">
                                            <img src="{% static "images/icons/down-arrow.png" %}" alt="Pull down"
                                                 class="d-none" height="10">
                                        </div>
                                    </div>
                                    <div class="card-body collapse show pl-5" id="airlineFilter">
                                        <ul class="p-0">
                                            {% for airline in airlines %}
                                                <li class="pb-3">
                                                    <input id="airline1" type="checkbox" class="form-check-input mr-2">
                                                    <label for="airline1">
                                                        <img class="mr-1" src="/images/{{ airline |aircon }}.png"
                                                             style="width: 25px;"/>
                                                        {{ airline | airlines }} Airlines
                                                    </label>
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                                <div class="card mt-3">
                                    <div class="card-header card-toggler bg-white cursor-pointer" data-toggle="collapse"
                                         data-target="#priceFilter">
                                        <div class="card-title mb-0 d-flex align-items-center justify-content-between">
                                            <h5 class="mb-0 p-2">Price</h5>
                                            <img src="{% static "images/icons/up-arrow.png" %}" alt="Pull Up"
                                                 class="" height="10">
                                            <img src="{% static "images/icons/down-arrow.png" %}" alt="Pull down"
                                                 class="d-none" height="10">
                                        </div>
                                    </div>
                                    <div class="card-body collapse show" id="priceFilter">
                                        <div class="mt-3 pl-3">Price Range Filter</div>
                                        <div id="filter_price_ammount" class="small mb-4 pl-3">$0 - $3000</div>
                                        <div class="slider-red slider-holder pl-3">
                                            <input id="filter_price_range" type="text" value=""
                                                   class="form-control">
                                        </div>
                                    </div>
                                </div>
                                <div class="card filter-by-time mt-3">
                                    <div class="card-header card-toggler bg-white cursor-pointer" data-toggle="collapse"
                                         data-target="#timeFilter">
                                        <div class="card-title mb-0 d-flex justify-content-between align-items-center">
                                            <h5 class="bold mb-0 p-2" style="font-weight: 600;">Time</h5>
                                            <img src="{% static "images/icons/up-arrow.png" %}" alt="Pull Down"
                                                 class="d-none" height="10">
                                            <img src="{% static "images/icons/down-arrow.png" %}" alt="Pull Up"
                                                 class="" height="10">
                                        </div>
                                    </div>
                                    <div class="card-body collapse" id="timeFilter">
                                        <div class="card-body pr-2">
                                            <ul class="nav d-flex slider-nav">
                                                <li class="nav-item">
                                                    <a class="nav-link active" href="#takeoff" data-toggle="tab">Take-off</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="#landing"
                                                       data-toggle="tab">Landing</a>
                                                </li>
                                            </ul>
                                            <div class="tab-content">
                                                <div class="tab-pane active show" id="takeoff">
                                                    <div class="mt-3">Departure City Take-off</div>
                                                    <div id="de_city_take_off_time" class="small mb-4">0:00AM -
                                                        11:59PM
                                                    </div>
                                                    <div class="slider-red slider-holder">
                                                        <input id="de_city_take_off" type="text" value=""
                                                               class="form-control">
                                                    </div>
                                                    <div class="mt-3">Arrival City Take-off</div>
                                                    <div id="arr_city_take_off_time" class="small mb-4">0:00AM -
                                                        11:59PM
                                                    </div>
                                                    <div class="slider-red slider-holder">
                                                        <input id="arr_city_take_off" type="text" value=""
                                                               class="form-control">
                                                    </div>
                                                </div>
                                                <div class="tab-pane" id="landing">
                                                    <div class="mt-3">Departure City Landing</div>
                                                    <div id="de_city_landing_time" class="small mb-4">0:00AM -
                                                        11:59PM
                                                    </div>
                                                    <div class="slider-red slider-holder">
                                                        <input id="de_city_landing" type="text" value=""
                                                               class="form-control">
                                                    </div>
                                                    <div class="mt-3">Arrival City Landing</div>
                                                    <div id="arr_city_landing_time" class="small mb-4">0:00AM -
                                                        11:59PM
                                                    </div>
                                                    <div class="slider-red slider-holder">
                                                        <input id="arr_city_landing" type="text" value=""
                                                               class="form-control">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card mt-3">
                                    <div class="card-header card-toggler bg-white cursor-pointer" data-toggle="collapse"
                                         data-target="#stopsFilter">
                                        <div class="card-title mb-0 d-flex align-items-center justify-content-between">
                                            <h5 class="mb-0 p-2">Stops</h5>
                                            <img src="{% static "images/icons/up-arrow.png" %}" alt="Pull Down"
                                                 class="d-none" height="10">
                                            <img src="{% static "images/icons/down-arrow.png" %}" alt="Pull Up"
                                                 class="" height="10">
                                        </div>
                                    </div>
                                    <div class="card-body collapse" id="stopsFilter">
                                        <div class="custom-control custom-radio mt-2">
                                            <input type="radio" id="filterNoStop" name="customRadio"
                                                   class="custom-control-input">
                                            <label class="custom-control-label" for="filterNoStop">No stops (direct
                                                flight)</label>
                                        </div>
                                        <div class="custom-control custom-radio mt-2">
                                            <input type="radio" id="customRadio1" name="customRadio"
                                                   class="custom-control-input">
                                            <label class="custom-control-label" for="customRadio1">Up to 1
                                                stop</label>
                                        </div>
                                        <div class="custom-control custom-radio mt-2">
                                            <input type="radio" id="filterStop2" name="customRadio"
                                                   class="custom-control-input">
                                            <label class="custom-control-label" for="filterStop2">Up to 2
                                                stops</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="placesModal" tabindex="-1" role="dialog"
                         aria-labelledby="placesModalCenterTitle"
                         aria-hidden="true">
                        <div class="modal-dialog " role="document">
                            <div class="modal-content" style="top: 160px;">
                                <div class="modal-body">
                                    <div class="row pop2_first">
                                        <div class="col-12" style="text-align:left; margin-bottom: 2%"><p
                                                id="placesModalTitle"></p>
                                        </div>
                                        <div class="col-12" style="text-align:right">
                                            <!--  <p style="color:#8092a9; cursor: pointer;"  @click="clearList"><i
                                                  class="fa fa-times" style="margin-left:5px"></i></p>--></div>
                                    </div>
                                    <div class="row pop2_second">
                                        <div class="col-12">
                                            <div>
                                                <div style="border: 1px solid #00B7FF; border-radius: 5px; padding: 2%">
                                                    <div class="search_selected_values">
                                                        <button class="sel_place_btn" style="margin: 2%"
                                                                id="mySelectedPlace">
                                                            <i class="fa fa-times-circle" style="margin-right:5px"
                                                               @click="clearPlaceItem(index)"></i>

                                                        </button>
                                                    </div>

                                                    <div class="pop2_hor_line" style="margin:10px 0px"></div>
                                                    <input class="pop2_input" type="text" v-model="city"
                                                           v-on:keyup="cityHandler"
                                                           onfocus="this.value=''"
                                                           placeholder="Add new location..."/>
                                                </div>

                                                <ol class="search_result_list">
                                                    <li v-for="(place, index) of searchResultPlaces">
                                                        <button class="btn search_result_list_item"
                                                                @click="setPlace(place.nameCity,place.codeIataCity,index)">
                                                            <i class="fa fa-building" style="padding-right: 2%"></i>
                                                            <i class="fa fa-plane" style="padding-right: 2%"
                                                               :hidden="true"></i>
                                                            {( place.nameCity )}
                                                        </button>
                                                        <button class="btn search_result_list_item"
                                                                @click="setPlace(place.nameCity,place.codeIataCity,index)">
                                                            <i class="fa fa-plane" style="padding-right: 2%"></i>
                                                            {( place.airport.nameAirport )}
                                                        </button>
                                                    </li>
                                                </ol>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="modal-footer">
                                    <button class="pop2_footer_left" data-dismiss="modal">Cancel</button>
                                    <button class="pop2_footer_right" @click="choosePlaces">Choose</button>
                                </div>
                            </div>
                        </div>
                    </div>
    </section>
    <div id="mobileIndicator"></div>
    {% include "_includes/footer.html" %}
{% endblock %}


{% block jscontent %}
    <script src="{% static "js/home.js" %}"></script>
    <script src="{% static "js/lightpick.js" %}"></script>
    <script src="{% static "js/bootstrap-slider.js" %}"></script>

    <script>
        $(document).ready(function () {
            var Stopover = new Slider("input#stopover", {
                min: 2,
                max: 24,
                step: 1,
                value: [2, 24],
                tooltip: "hide",
                formatter: stopover
            });
            Stopover.on('slideStop', function () {
            }).on('slide', function () {
                stopover(Stopover.getValue());
            });
        });

        function stopover(val) {
            if (Array.isArray(val)) {
                $(".stopover").text(val[0] + ' - ' + val[1] + ' hours');
            } else {
                //$(".stopover").text(val + ' hours');
            }
        }

        $(document).ready(function () {
            var DeCityTakeOff = new Slider("input#de_city_take_off", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            DeCityTakeOff.on('slideStop', function () {
                var range = getTime(DeCityTakeOff.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.depTake.min = range[0];
                    app.timeFilterParams.depTake.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#de_city_take_off_time").text(timeFormatter(DeCityTakeOff.getValue()));
            });
            var ArrCityTakeOff = new Slider("input#arr_city_take_off", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            ArrCityTakeOff.on('slideStop', function () {
                var range = getTime(ArrCityTakeOff.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.arrTake.min = range[0];
                    app.timeFilterParams.arrTake.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#arr_city_take_off_time").text(timeFormatter(ArrCityTakeOff.getValue()));
            });
            var DeCityLanding = new Slider("input#de_city_landing", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            DeCityLanding.on('slideStop', function () {
                var range = getTime(DeCityLanding.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.depLand.min = range[0];
                    app.timeFilterParams.depLand.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#de_city_landing_time").text(timeFormatter(DeCityLanding.getValue()));
            });
            var ArrCityLanding = new Slider("input#arr_city_landing", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            ArrCityLanding.on('slideStop', function () {
                var range = getTime(ArrCityLanding.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.arrLand.min = range[0];
                    app.timeFilterParams.arrLand.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#arr_city_landing_time").text(timeFormatter(ArrCityLanding.getValue()));
            });
            var filterPriceRange = new Slider("input#filter_price_range", {
                min: 0,
                max: 3000,
                step: 15,
                value: [0, 3000],
                tooltip: "hide"
            });
            filterPriceRange.on('slide', function () {
                $("#filter_price_ammount").text(getPriceRange(filterPriceRange.getValue()));
            });
        });

        function getPriceRange(rangeVal) {
            var rangeMin = rangeVal[0];
            var rangeMax = rangeVal[1];
            return "$" + rangeMin + " - $" + rangeMax;
        }

        function getTime(val) {
            if (Array.isArray(val)) {
                var time = ['00:00', '23:59'];
                var hour = Math.floor(val[0] / 60);
                var minute = val[0] - hour * 60;
                time[0] = (hour >= 10 ? hour : '0' + hour) + ':' + (minute >= 10 ? minute : '0' + minute);
                hour = Math.floor(val[1] / 60);
                minute = val[1] - hour * 60;
                time[1] = (hour >= 10 ? hour : '0' + hour) + ':' + (minute >= 10 ? minute : '0' + minute);
                return time;
            }
            return null;
        }

        function timeFormatter(val) {
            if (Array.isArray(val)) {
                var hours1 = Math.floor(val[0] / 60);
                var minutes1 = val[0] - hours1 * 60;

                if (hours1.length == 1) hours1 = '0' + hours1;
                if (minutes1.length == 1) minutes1 = '0' + minutes1;
                if (minutes1 == 0) minutes1 = '00';
                if (hours1 >= 12) {
                    if (hours1 == 12) {
                        hours1 = hours1;
                        minutes1 = minutes1 + " PM";
                    } else {
                        hours1 = hours1 - 12;
                        minutes1 = minutes1 + " PM";
                    }
                } else {
                    hours1 = hours1;
                    minutes1 = minutes1 + " AM";
                }
                if (hours1 == 0) {
                    //hours1 = 12;
                    minutes1 = minutes1;
                }
                var minTime = hours1 + ':' + minutes1;

                var hours2 = Math.floor(val[1] / 60);
                var minutes2 = val[1] - hours2 * 60;

                if (hours2.length == 1) hours2 = '0' + hours2;
                if (minutes2.length == 1) minutes2 = '0' + minutes2;
                if (minutes2 == 0) minutes2 = '00';
                if (hours2 >= 12) {
                    if (hours2 == 12) {
                        hours2 = hours2;
                        minutes2 = minutes2 + " PM";
                    } else if (hours2 == 24) {
                        hours2 = 11;
                        minutes2 = "59 PM";
                    } else {
                        hours2 = hours2 - 12;
                        minutes2 = minutes2 + " PM";
                    }
                } else {
                    hours2 = hours2;
                    minutes2 = minutes2 + " AM";
                }

                var maxTime = hours2 + ':' + minutes2;
                return minTime + " - " + maxTime;
            } else {
                var hour = Math.floor(val / 60);
                var minute = val - hour * 60;

                if (hour.length == 1) hour = '0' + hour;
                if (minute.length == 1) minute = '0' + minute;
                if (minute == 0) minute = '00';
                if (hour >= 12) {
                    if (hour == 12) {
                        hour = hour;
                        minute = minute + " PM";
                    } else {
                        hour = hour - 12;
                        minute = minute + " PM";
                    }
                } else {
                    hour = hour;
                    minute = minute + " AM";
                }
                if (hour == 0) {
                    //hour = 12;
                    minute = minute;
                }
                return hour + ':' + minute;
            }
        }

        let tripButton = document.querySelector(".btn-group");
        let picker = new Lightpick({
            field: document.getElementById('departure_date'),
            secondField: document.getElementById('return_date'),
            singleDate: false,
            onSelect: function (start, end) {
                var str = '';
                str += start ? start.format('Do MMMM YYYY') + ' to ' : '';
                str += end ? end.format('Do MMMM YYYY') : '...';
                {#document.getElementById('result-3').innerHTML = str;#}
            }
        });

        $(document).ready(function () {
            var is_mobile = false;
            if ($('#mobileIndicator').css('display') == 'none') {
                is_mobile = true;
            }
            if (is_mobile == true) {
                $('.search-bar-section').removeClass('sticky-top');
            } else {
                $('.search-bar-section').addClass('sticky-top')
            }
            $('.card-toggler').on('click', function () {
                $(this).find('.card-title').find('img').toggleClass('d-none');
            })
            $('.result-toggler').on('click', function () {
                $(this).find('.arrow-indicator').find('img').toggleClass('d-none');
            })
        });
        $(window).on('resize', function () {
            var is_mobile = false;
            if ($('#mobileIndicator').css('display') == 'none') {
                is_mobile = true;
            }
            if (is_mobile == true) {
                $('.search-bar-section').removeClass('sticky-top');
            } else {
                $('.search-bar-section').addClass('sticky-top')
            }
        });
    </script>
{% endblock %}
